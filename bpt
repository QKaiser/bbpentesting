#!/bin/sh
#
# BlackBerry Pentesting Tools - Simple bash script to automate task performed during blackberry pentests.
# 
# Author: Quentin Kaiser <quentin_AT_gremwell.com>
#

if [ "$1" = "setup" ]; then
	if [ ! -z `which barry` ]; then
		echo "[+] Installing barry ...";
		sudo apt-get install -y barry-doc barry-util barrybackup-gui barrydesktop 
	fi
	for i in `find coddec -name '*.java'`; do javac $i; done	
elif [ "$1" = "device" ]; then
	bidentify
	btool -t 
elif [ "$1" = "pm" ]; then
	bjavaloader dir | cut -d" " -f3 | grep -v "^$"
elif [ "$1" = "logs" ]; then
	bjavaloader eventlog
elif [ "$1" = "crashlogs" ]; then
	bjavaloader logstacktraces
elif [ "$1" = "decompile" ]; then
	mkdir -p decompiled
	java -classpath coddec/src net.rim.tools.compiler.Compiler $2	
	strings $2 > decompiled/strings.txt
	binwalk --dd='.*' $2
else
	echo "Usage: $0 command [options]\n\nAvailable commands:\n\t* setup: install all dependencies\n\t* device: list device info\n\t* pm: list installed applications\n\t* logcat: display device syslogs\n\t* crashlogs: display stack traces\n\t* decompile: decompile a .cod application\n"
fi
